<div class="scroll-container">
  <header class="header" role="banner">
    <div class="header-container">
      <div class="header-title-wrapper">
        <span class="header-icon" aria-label="Ícono decorativo de hoja">🌿</span>
        <h1 class="header-title">Agregar Nueva Planta</h1>
      </div>
    </div>
  </header>

  <main class="content-container">
    <section class="form-card">
      <form class="plant-form" (ngSubmit)="addPlant()">
        <fieldset class="form-section image-section">
          <legend class="sr-only">Subir imagen de la planta</legend>
          <div class="image-upload-container">
            <label class="image-upload-label" for="fileInput" tabindex="0" aria-label="Subir imagen de la planta">
              📸 Subir imagen
              <input type="file" (change)="onFileSelected($event)" accept="image/*" class="image-input" id="fileInput"
                #fileInput aria-describedby="image-help">
            </label>
            <span id="image-help" class="sr-only">Sube una imagen de tu planta para previsualizarla.</span>
            <div class="image-preview" *ngIf="img">
              <img [src]="img" alt="Previsualización de la planta">
            </div>
          </div>
        </fieldset>

        <fieldset class="form-section form-group">
          <legend class="sr-only">Detalles de la planta</legend>
          <div class="form-field">
            <span class="form-icon" aria-hidden="true">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24">
                <path
                  d="M12 2C9.24 2 7 4.24 7 7c0 2.76 2.24 5 5 5s5-2.24 5-5c0-2.76-2.24-5-5-5zm0 8c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3zm0 2c-4.42 0-8 3.58-8 8h2c0-3.31 2.69-6 6-6s6 2.69 6 6h2c0-4.42-3.58-8-8-8z"
                  fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </span>
            <div class="input-container">
              <label class="input-label" for="name">Nombre de la planta</label>
              <input [(ngModel)]="name" name="name" id="name" class="custom-input" placeholder="Ej: Suculenta"
                aria-describedby="name-help" aria-required="true">
              <span id="name-help" class="sr-only">Ingresa el nombre de tu planta, por ejemplo, Suculenta.</span>
            </div>
          </div>

          <div class="form-field">
            <span class="form-icon" aria-hidden="true">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24">
                <path
                  d="M17 3H7a2 2 0 00-2 2v2c0 1.1.9 2 2 2h10a2 2 0 002-2V5a2 2 0 00-2-2zm0 4H7V5h10v2zm-2 4l-3 3-3-3H5l4 4v6h2v-6l4-4h-2z"
                  fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </span>
            <div class="input-container">
              <label class="input-label" for="horario">Riego cada (horas)</label>
              <input type="time" [(ngModel)]="horario" name="horario" id="horario" class="custom-input"
                placeholder="Ej: 48" aria-describedby="horario-help" aria-required="true">
              <span id="horario-help" class="sr-only">Selecciona el intervalo de riego en horas.</span>
            </div>
          </div>

          <div class="form-field">
            <span class="form-icon" aria-hidden="true">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24">
                <path
                  d="M12 2a10 10 0 00-7 2.93V5a1 1 0 00-2 0v2.07A10 10 0 002 12a1 1 0 002 0 8 8 0 0116 0 1 1 0 002 0 10 10 0 00-10-10zm0 16a1 1 0 01-1-1v-4a1 1 0 012 0v4a1 1 0 01-1 1z"
                  fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </span>
            <div class="input-container">
              <label class="input-label" for="humedad">Humedad requerida (%)</label>
              <input type="number" [(ngModel)]="humedad" name="humedad" id="humedad" class="custom-input"
                placeholder="Ej: 60" aria-describedby="humedad-help" aria-required="true">
              <span id="humedad-help" class="sr-only">Ingresa el porcentaje de humedad requerido.</span>
            </div>
          </div>
        </fieldset>

        <div class="form-section status-section">
          <div class="status-message" *ngIf="errorMessage"
            [ngClass]="{'success': errorMessage.includes('exitosamente'), 'error': !errorMessage.includes('exitosamente')}"
            aria-live="polite">
            {{ errorMessage }}
          </div>
        </div>

        <div class="form-section button-section">
          <button type="submit" class="submit-button" [disabled]="isSubmitting"
            aria-label="Agregar nueva planta al jardín">
            <span class="button-icon-wrapper">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24">
                <path
                  d="M12 2a10 10 0 00-10 10c0 4.42 3.58 8 8 8s8-3.58 8-8a1 1 0 012 0 10 10 0 00-10-10zm0 14c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z"
                  fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </span>
            {{ isSubmitting ? 'Agregando...' : 'Agregar a mi jardín' }}
          </button>
        </div>
      </form>
    </section>
  </main>
</div>