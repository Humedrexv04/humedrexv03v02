<!-- Contenedor Principal -->
<div class="scroll-container">
  <!-- Sección de Encabezado -->
  <header class="header-section" role="banner">
    <div class="header-content">
      <h1 class="header-title">Editar Planta</h1>
      <div class="header-buttons">
        <button type="button" class="primary-button cancel-button" (click)="gotoPlantDetail()"
          aria-label="Cancelar edición">
          Cancelar
        </button>
      </div>
    </div>
  </header>

  <!-- Contenido Principal -->
  <main class="main-container" role="main">
    <div class="form-container">
      <form *ngIf="plant" class="plant-form" role="form" aria-labelledby="edit-plant-title">
        <!-- Mensaje de error -->
        <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>
        
        <!-- Botones para capturar imagen -->
        <div class="image-buttons">
          <!-- Botón para usar la cámara -->
          <button 
            type="button" 
            class="field-base image-upload camera-button" 
            (click)="captureImage()"
            [disabled]="isCapturingImage"
            [ngClass]="{'loading': isCapturingImage}"
            aria-label="Tomar foto con la cámara">
            <span class="camera-icon">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24">
                <path d="M4 5h3l2-2h6l2 2h3a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2z" fill="none"
                  stroke="currentColor" stroke-width="2" />
                <circle cx="12" cy="13" r="4" fill="none" stroke="currentColor" stroke-width="2" />
              </svg>
            </span>
            <span *ngIf="!isCapturingImage">Cambiar foto</span>
            <span *ngIf="isCapturingImage">Capturando...</span>
          </button>
        </div>

        <!-- Vista previa de imagen -->
        <div class="image-preview-wrapper" *ngIf="img">
          <img [src]="img" alt="Previsualización de la planta" class="preview-image" />
        </div>
        <div class="image-preview" *ngIf="!img && plant.img">
          <img [src]="plant.img" alt="Imagen actual de la planta" class="preview-image" />
        </div>

        <!-- Campo de Nombre -->
        <div class="form-field field-base text-input">
          <input id="plant-name" type="text" [(ngModel)]="plant.name" name="name" required class="custom-input"
            placeholder="Nombre" aria-required="true" />
        </div>

        <!-- Campo de Horario -->
        <div class="form-field field-base time-input">
          <input id="plant-horario" type="time" [(ngModel)]="plant.horario" name="horario" required class="custom-input"
            aria-required="true" />
        </div>

        <!-- Campo de Humedad -->
        <div class="form-field field-base number-input">
          <input id="plant-humedad" type="number" [(ngModel)]="plant.humedad" name="humedad" required
            class="custom-input" placeholder="Humedad (%)" aria-required="true" 
            min="1" max="100" (change)="onHumedadChange()" />
        </div>

        <!-- Botón de Actualizar -->
        <button type="button" class="submit-button" (click)="updatePlant()" [disabled]="isSubmitting">
          <span *ngIf="!isSubmitting">Actualizar Planta</span>
          <span *ngIf="isSubmitting">Actualizando...</span>
        </button>
      </form>
    </div>
  </main>
</div>